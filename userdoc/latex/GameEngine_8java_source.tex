\hypertarget{GameEngine_8java_source}{\section{Game\-Engine.\-java}
}

\begin{DoxyCode}
00001 \textcolor{keyword}{import} java.util.Scanner;
00002 \textcolor{keyword}{import} java.util.ArrayList;
00003 \textcolor{keyword}{import} java.util.Random;
00004 \textcolor{keyword}{import} java.io.File;
00005 \textcolor{keyword}{import} java.io.FileNotFoundException;
00006 
\hypertarget{GameEngine_8java_source_l00013}{}\hyperlink{classGameEngine}{00013} \textcolor{keyword}{public} \textcolor{keyword}{class }\hyperlink{classGameEngine}{GameEngine}
00014 \{
00018     \textcolor{keyword}{private} \hyperlink{classPlayer}{Player} player;
00019 
00023     ArrayList<Room> gameRooms;
00024 
00028     \textcolor{keyword}{private} \hyperlink{classUserInterface}{UserInterface} gui;
00029 
00036     \textcolor{keyword}{private} \textcolor{keywordtype}{int} helpCount;
00037 
00042     \textcolor{keyword}{private} \textcolor{keywordtype}{int} commandCountDown;
00043 
\hypertarget{GameEngine_8java_source_l00047}{}\hyperlink{classGameEngine_a9e8a92f5021a34293060f9aaff4005de}{00047}     \textcolor{keyword}{public} \hyperlink{classGameEngine_a9e8a92f5021a34293060f9aaff4005de}{GameEngine}() \{
00048         gameRooms = \textcolor{keyword}{new} ArrayList<Room>();
00049         player = \textcolor{keyword}{new} \hyperlink{classPlayer}{Player}((javax.swing.JOptionPane.showInputDialog(\textcolor{stringliteral}{"What is your name"}).toLowerCase
      ().equals(\textcolor{stringliteral}{"retard"}))? \textcolor{stringliteral}{"moron"} : \textcolor{stringliteral}{"retard"}, createRooms());
00050         javax.swing.JOptionPane.showMessageDialog(null, \textcolor{stringliteral}{"Whatever, I'll call you "} + player.getName() + \textcolor{stringliteral}{"."}
      );
00051         helpCount = 0;
00052         commandCountDown = 42;
00053     \}
00054 
\hypertarget{GameEngine_8java_source_l00059}{}\hyperlink{classGameEngine_aec901a5b590b3cd204f196165da5dfb6}{00059}     \textcolor{keyword}{public} \textcolor{keywordtype}{void} \hyperlink{classGameEngine_aec901a5b590b3cd204f196165da5dfb6}{setGUI}(\hyperlink{classUserInterface}{UserInterface} userInterface) \{
00060         gui = userInterface;
00061         gui.setCommandsLeft(commandCountDown);
00062         printWelcome();
00063     \}
00064 
00068     \textcolor{keyword}{private} \textcolor{keywordtype}{void} printWelcome() \{
00069         gui.println(\textcolor{stringliteral}{"Greetings human."});
00070         gui.println(\textcolor{stringliteral}{"I see the assassins have failed. Too bad..."});
00071         gui.println(\textcolor{stringliteral}{"You know what they say: if you want something done, do it yourself."});
00072         gui.println(\textcolor{stringliteral}{"At least I can see that you don't remember anything. At last something that I can take
       advantage of."});
00073         gui.println(\textcolor{stringliteral}{"That was predictable, human minds are weak."});
00074         gui.println(\textcolor{stringliteral}{"\(\backslash\)nBecause you're stupid, I will describe you everything that will be around us."});
00075         gui.println(\textcolor{stringliteral}{"Who knows ? Maybe you can turn into something useful. One day. Maybe."});
00076         gui.println(\textcolor{stringliteral}{"\(\backslash\)nBeware: Death is coming!\(\backslash\)n"});
00077         gui.println(player.getCurrentRoom().getLongDescription());
00078         gui.showImage(player.getCurrentRoom().getImageName());
00079     \}
00080 
00085     \textcolor{keyword}{private} \hyperlink{classRoom}{Room} createRooms() \{
00086         \textcolor{comment}{// create the rooms}
00087         \hyperlink{classRoom}{Room} temperateBroadleaf = \textcolor{keyword}{new} \hyperlink{classRoom}{Room}(\textcolor{stringliteral}{"in temperate forest"}, \textcolor{stringliteral}{"temperatebroadleaf.jpg"});
00088         temperateBroadleaf.addItem(\textcolor{keyword}{new} \hyperlink{classItem}{Item}(\textcolor{stringliteral}{"wand"}, 3, \textcolor{stringliteral}{"just an ordinary wand"}));
00089 
00090         \hyperlink{classRoom}{Room} taiga = \textcolor{keyword}{new} \hyperlink{classRoom}{Room}(\textcolor{stringliteral}{"in a boreal forest"}, \textcolor{stringliteral}{"taiga.jpg"});
00091         taiga.addItem(\textcolor{keyword}{new} \hyperlink{classItem}{Item}(\textcolor{stringliteral}{"snowball"}, 1, \textcolor{stringliteral}{"some weirdly yellowy snowball"}));
00092         taiga.addItem(\textcolor{keyword}{new} \hyperlink{classItem}{Item}(\textcolor{stringliteral}{"bird"}, 6, \textcolor{stringliteral}{"a frozen inert black bird"}));
00093 
00094         \hyperlink{classRoom}{Room} alpineTundra = \textcolor{keyword}{new} \hyperlink{classRoom}{Room}(\textcolor{stringliteral}{"on an alpine mountain"}, \textcolor{stringliteral}{"alpinetundra.jpg"});
00095         alpineTundra.addItem(\textcolor{keyword}{new} \hyperlink{classItem}{Item}(\textcolor{stringliteral}{"rock"}, 15, \textcolor{stringliteral}{"a surprisingly solid magnificent rock"}));
00096         alpineTundra.addItem(\textcolor{keyword}{new} \hyperlink{classItem}{Item}(\textcolor{stringliteral}{"plank"}, 10, \textcolor{stringliteral}{"a plank of wood, maybe from a chalet"}));
00097         alpineTundra.addItem(\textcolor{keyword}{new} \hyperlink{classItem}{Item}(\textcolor{stringliteral}{"snowball"}, 1, \textcolor{stringliteral}{"a snowball. Yes, there is still snow in an alpine
       biome."}));
00098 
00099         \hyperlink{classRoom}{Room} steppe = \textcolor{keyword}{new} \hyperlink{classRoom}{Room}(\textcolor{stringliteral}{"on a vast grass plain"}, \textcolor{stringliteral}{"steppe.jpg"});
00100         steppe.addItem(\textcolor{keyword}{new} \hyperlink{classItem}{Item}(\textcolor{stringliteral}{"grass"}, 1, \textcolor{stringliteral}{"a tuft of yellowish grass. Looking at the grass made you
       look like stupid"}));
00101 
00102         \hyperlink{classRoom}{Room} cave = \textcolor{keyword}{new} \hyperlink{classRoom}{Room}(\textcolor{stringliteral}{"inside a dark cave"}, \textcolor{stringliteral}{"cave.jpg"});
00103         cave.addItem(\textcolor{keyword}{new} \hyperlink{classItem}{Item}(\textcolor{stringliteral}{"magiccookie"}, 3, \textcolor{stringliteral}{"a pretend magic cookie with mould on it, probably left
       there for many years. The use-by date has faded out. Why not eat it?"}));
00104 
00105         \hyperlink{classRoom}{Room} polarDesert = \textcolor{keyword}{new} \hyperlink{classRoom}{Room}(\textcolor{stringliteral}{"in a cold polar desert"}, \textcolor{stringliteral}{"polardesert.jpg"});
00106         polarDesert.addItem(\textcolor{keyword}{new} \hyperlink{classItem}{Item}(\textcolor{stringliteral}{"ice"}, 5, \textcolor{stringliteral}{"a little block of ice. But you don't have any drink"}));
00107 
00108         \hyperlink{classRoom}{Room} xericShrublands = \textcolor{keyword}{new} \hyperlink{classRoom}{Room}(\textcolor{stringliteral}{"in a sand desert"}, \textcolor{stringliteral}{"xericshrublands.jpg"});
00109         xericShrublands.addItem(\textcolor{keyword}{new} \hyperlink{classItem}{Item}(\textcolor{stringliteral}{"shrub"}, 10, \textcolor{stringliteral}{"a spicky shrub. Useful if you want to make a
       shruberry"}));
00110 
00111         \hyperlink{classRoom}{Room} savanna = \textcolor{keyword}{new} \hyperlink{classRoom}{Room}(\textcolor{stringliteral}{"in a savanna"}, \textcolor{stringliteral}{"savanna.jpg"});
00112         savanna.addItem(\textcolor{keyword}{new} \hyperlink{classItem}{Item}(\textcolor{stringliteral}{"elephant"}, 1000, \textcolor{stringliteral}{"a huge elephant looking at you, dazed. I bet he's
       smarter than you"}));
00113         savanna.addItem(\textcolor{keyword}{new} \hyperlink{classItem}{Item}(\textcolor{stringliteral}{"grass"}, 1, \textcolor{stringliteral}{"a tuft of yellowish grass. You may have other things to
       do instead of looking at that"}));
00114 
00115         \textcolor{comment}{// initialise room exits}
00116         temperateBroadleaf.setExit(\textcolor{stringliteral}{"east"}, taiga);
00117         temperateBroadleaf.setExit(\textcolor{stringliteral}{"south"}, steppe);
00118 
00119         taiga.setExit(\textcolor{stringliteral}{"west"}, temperateBroadleaf);
00120         taiga.setExit(\textcolor{stringliteral}{"east"}, alpineTundra);
00121         taiga.setExit(\textcolor{stringliteral}{"south"}, cave);
00122 
00123         alpineTundra.setExit(\textcolor{stringliteral}{"west"}, taiga);
00124         alpineTundra.setExit(\textcolor{stringliteral}{"south"}, polarDesert);
00125 
00126         steppe.setExit(\textcolor{stringliteral}{"north"}, temperateBroadleaf);
00127         steppe.setExit(\textcolor{stringliteral}{"east"}, cave);
00128         steppe.setExit(\textcolor{stringliteral}{"south"}, xericShrublands);
00129 
00130         cave.setExit(\textcolor{stringliteral}{"north"}, taiga);
00131         cave.setExit(\textcolor{stringliteral}{"south"}, savanna);
00132         cave.setExit(\textcolor{stringliteral}{"east"}, polarDesert);
00133         cave.setExit(\textcolor{stringliteral}{"west"}, steppe);
00134 
00135         \textcolor{comment}{// Trap Door}
00136         \textcolor{comment}{// polarDesert.setExit("north", alpineTundra);}
00137         polarDesert.setExit(\textcolor{stringliteral}{"west"}, cave);
00138 
00139         xericShrublands.setExit(\textcolor{stringliteral}{"north"}, steppe);
00140         xericShrublands.setExit(\textcolor{stringliteral}{"east"}, savanna);
00141 
00142         savanna.setExit(\textcolor{stringliteral}{"north"}, cave);
00143         savanna.setExit(\textcolor{stringliteral}{"west"}, xericShrublands);
00144 
00145         \hyperlink{classRoom}{Room} randomRoom = \textcolor{keyword}{new} \hyperlink{classRoom}{Room}(\textcolor{stringliteral}{""}, \textcolor{stringliteral}{""});
00146 
00147         polarDesert.setExit(\textcolor{stringliteral}{"south"}, randomRoom);
00148         savanna.setExit(\textcolor{stringliteral}{"east"}, randomRoom);
00149 
00150         gameRooms.add(randomRoom);
00151         gameRooms.add(temperateBroadleaf);
00152         gameRooms.add(taiga);
00153         gameRooms.add(alpineTundra);
00154         gameRooms.add(steppe);
00155         gameRooms.add(cave);
00156         gameRooms.add(polarDesert);
00157         gameRooms.add(xericShrublands);
00158         gameRooms.add(savanna);
00159 
00160         \textcolor{keywordflow}{return} temperateBroadleaf;
00161     \}
00162 
\hypertarget{GameEngine_8java_source_l00167}{}\hyperlink{classGameEngine_ad7133885f313fa99bca3bb7cb8272f64}{00167}     \textcolor{keyword}{public} \textcolor{keywordtype}{void} \hyperlink{classGameEngine_ad7133885f313fa99bca3bb7cb8272f64}{processCommand}(String commandLine) \{
00168         gui.println(\textcolor{stringliteral}{"\(\backslash\)n"} + commandLine + \textcolor{stringliteral}{"\(\backslash\)n"});
00169         Command command = Parser.getCommand(commandLine);
00170 
00171         \textcolor{keywordflow}{if}(command == null) \{
00172             gui.println(\textcolor{stringliteral}{"I don't know what you mean..."});
00173             \textcolor{keywordflow}{return};
00174         \}
00175 
00176         gui.setCommandsLeft(--commandCountDown);
00177 
00178         \textcolor{keywordflow}{try} \{
00179             \textcolor{keywordtype}{boolean} quit = command.execute(player);
00180 
00181             \textcolor{keywordflow}{if}(command.hasMessage())
00182                 gui.\hyperlink{classUserInterface_a79f606b4b1f5d1523e50eea00039ed94}{println}(command.getMessage());
00183             \textcolor{comment}{// If we can cast the command into a GoCommand}
00184             \textcolor{comment}{// Or if it is the test command}
00185             \textcolor{keywordflow}{if}(\hyperlink{classGoCommand}{GoCommand}.class.isInstance(command) || command.getClass().equals(
      \hyperlink{classTestCommand}{TestCommand}.class)) \{
00186                 \textcolor{comment}{// The game image is reloaded}
00187                 \textcolor{keywordflow}{if}(player.\hyperlink{classPlayer_a3a3107df50fc4e35e8c0f46c3f776ce6}{getCurrentRoom}().getImageName() != null) \{
00188                     gui.showImage(player.getCurrentRoom().getImageName());
00189                 \}
00190             \}
00191 
00192             \textcolor{keywordflow}{if}(quit) \{
00193                 endGame(\textcolor{keyword}{false});
00194             \}
00195         \} \textcolor{keywordflow}{catch}(\hyperlink{classNoArgumentException}{NoArgumentException} e) \{
00196             gui.println(e.getMessage());
00197         \} \textcolor{keywordflow}{catch}(\hyperlink{classIllegalArgumentException}{IllegalArgumentException} e) \{
00198             gui.println(e.getMessage());
00199         \} \textcolor{keywordflow}{catch}(\hyperlink{classUnauthorizedException}{UnauthorizedException} e) \{
00200             gui.println(e.getMessage());
00201         \}
00202 
00203         \textcolor{keywordflow}{if}(commandCountDown == 0) \{
00204             endGame(\textcolor{keyword}{false});
00205         \}
00206 
00207     \}
00208 
00213     \textcolor{keyword}{private} \textcolor{keywordtype}{void} endGame(\textcolor{keywordtype}{boolean} winning) \{
00214         gui.println(\textcolor{stringliteral}{"Thank you for playing. Good bye. By the way, you "}
00215                 + ((winning)? \textcolor{stringliteral}{"won"} : \textcolor{stringliteral}{"lost"}) + \textcolor{stringliteral}{"."});
00216         gui.enable(\textcolor{keyword}{false});
00217     \}
00218 
00219 \}
\end{DoxyCode}
